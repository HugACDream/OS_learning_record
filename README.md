# OS_learning_record
## 7.13 
### 一、概况
- 学习xv6第零章 操作系统接口部分，主要学习了相关系统调用的功能。

### 二、笔记
- 第零章
    - fork函数：调用一次，返回两次（子进程返回0， 父进程返回子进程id）。将原程序从fork函数所在的位置创建出一个新的分支（子进程），两个分支同时进行至结束。
    - wait函数：等待当前进程的一个子进程结束并返回id
    - exec函数：调用指定位置的程序（第二章展开讲）
    - 文件描述符：代表文件被内核管理的对象。0标准输入，1标准输出，2错误输出
    - read&write：从当前文件偏移处读取/写入字节
    - close：释放文件描述符，从而达到关闭文件的效果
    - 管道：小缓冲区，一端写，一段读，同样以文件描述符的形式提供给进程。数据未准备好之前read会一直等待。区别于临时文件，管道可以自我清扫、传输任意长度数据且允许同步
    - 文件系统：包括文件和目录（字节数组和目录树）
    - chdir：更换目录
    - mkdir：创建新目录
    - mknod：创建新的设备文件（空文件）
    - fstat：获取文件信息
    - 连接：同一个文件有不同的名字（link）
    - 文件删除时，只有所有连接都删除了才删除文件。

### 三、明日计划
- 学习xv6第一章

## 7.14
### 一、概况
- 查找了xv6的源码，从https://github.com/mit-pdos/xv6-riscv.git 克隆了一份源码，方便对照源码学习
- 结合源码学习了第一章的前半部分
### 二、笔记
- xv6使用页表实现进程的内存分配，进程的状态信息位于xv6/kernel/proc.h中
- 程序都具有内核栈和用户栈，执行用户代码时内核栈为空，通过系统调用或中断进入内核时，内核代码在内核栈执行，用户栈保存数据，暂时不活跃。
- %cr3寄存器存储entrypgdir（汇编课上讲的页目录起始地址）
- 虚拟地址=物理地址 + 0x80000000（KERNBASE）
- entry.S：设置每个cpu的独立栈，并跳转到C代码start()
- 创建第一个进程使用userinit函数，函数实现过程：创建并分配进程结构体，设置用户内存空间、设置用户态执行上下文、初始化进程信息、标记进程为可执行

### 三、明日计划
- 明后两天打算法比赛+志愿服务活动